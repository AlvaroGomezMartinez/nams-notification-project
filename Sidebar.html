<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body { font-family: Arial, sans-serif; margin: 16px; }
      label { display: block; margin-top: 12px; }
      input, select, button { margin-top: 4px; width: 100%; padding: 6px; }
      #notification { color: red; font-weight: bold; margin-top: 12px; }
    </style>
  </head>
  <body>
    <h2>Restroom Log</h2>
    <form id="restroomForm">
      <label>Student ID
        <input type="text" id="studentId" required>
      </label>
      <label>G or B
        <select id="gb" required>
          <option value="">Select...</option>
          <option value="G">G</option>
          <option value="B">B</option>
        </select>
      </label>
      <label>Period
        <select id="period" required>
          <option value="1">1st</option>
          <option value="2">2nd</option>
          <option value="3">3rd</option>
          <option value="4">4th</option>
          <option value="5">5th</option>
          <option value="6">6th</option>
          <option value="7">7th</option>
          <option value="8">8th</option>
        </select>
      </label>
  <button type="button" onclick="logUsage('Out')">Out</button>
  <button type="button" onclick="logUsage('Back')">Back</button>
    </form>
    <div id="notification"></div>
    <script>
      function logUsage(action) {
        var studentId = document.getElementById('studentId').value;
        var gb = document.getElementById('gb').value;
        var period = document.getElementById('period').value;
        var note = document.getElementById('notification');
        if (!studentId || !period || !gb) return;
        google.script.run.withSuccessHandler(function(result) {
          if (result && result.error) {
            note.textContent = result.error;
          } else if (action === 'Out' && result && result.count >= 2) {
            note.textContent = 'Alert: This student has already used the restroom twice today!';
          } else {
            note.textContent = '';
          }
        }).logRestroomUsage({studentId: studentId, period: period, gb: gb, action: action});
      }
    </script>
  </body>
</html>
